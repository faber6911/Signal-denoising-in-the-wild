# File to recover the Kaldi docker

## Download and prepare data

- Create in the main dir: mkdir -p /export/corpora/
- cd /export/corpora/
- curl -O  https://phonogenres.unige.ch/downloads/siwis_latest.zip (Download siwis database)
- unzip -q siwis_latest.zip
- rm siwis_latest.zip
- curl -O http://www.openslr.org/resources/17/musan.tar.gz (Download musan dataset)
- tar -xf musan.tar.gz
- rm musan.tar.gz

## Download and prepare anaconda

- cd /tmp
- curl -O https://repo.anaconda.com/archive/Anaconda3-2020.02-Linux-x86_64.sh
- bash Anaconda3-2020.02-Linux-x86_64.sh
- source ~/.bashrc
- conda config --set auto_activate_base false

## Install kaldi

- cd /opt/kaldi/tools
- extras/check_dependencies.sh
- extras/install_mkl.sh
- extras/check_dependencies.sh

IF everything ok then:
- make -j 8
- extras/install_irstlm.sh

- cd /opt/kaldi/src
- ./configure --shared
- make depend -j 8; make -j 8
- echo "export KALDI_ROOT="/opt/kaldi/" >> ~/.profile

## Install screen

- apt-get install screen
- cp /etc/screenrc /root/.screenrc
- echo "defshell -bash" >> ~/.screenrc

## Pull git repo

- ssh-keygen -t rsa -b 4096 -C f.dintinosante@campus.unimib.it"
- ssh-add ~/.ssh/id_rsa
- add on Github
- cd /opt/kaldi/egs
- git clone git@github.com:faber6911/Signal-denoising-in-the-wild.git
- conda env create -f kalditorch.yml
- conda activate kalditorch
- jupyter notebook --generate-config
- cp /home/jupyter_notebook_config.py /root/.jupyter/jupyter_notebook_config.py

DONE